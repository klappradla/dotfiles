let g:ruby_path = system('echo $HOME/.rbenv/shims') " speed up vim-ruby

" Plugins (require vim-plug)
call plug#begin('~/.vim/plugged')
Plug 'ctrlpvim/ctrlp.vim'
Plug 'scrooloose/nerdtree'
Plug 'itchyny/lightline.vim'
Plug 'altercation/vim-colors-solarized'
Plug 'elixir-lang/vim-elixir'
Plug 'tpope/vim-commentary'
Plug 'godlygeek/tabular'
Plug 'plasticboy/vim-markdown'
Plug 'alvan/vim-closetag'
Plug 'slim-template/vim-slim'
Plug 'fatih/vim-go'
Plug 'pbrisbin/vim-mkdir'
Plug 'jiangmiao/auto-pairs'
call plug#end()

" Plugin specific settings
let NERDTreeShowHidden=1
let g:NERDTreeWinSize=25
let g:ctrlp_show_hidden=1
let g:vim_markdown_folding_disabled = 1    " disable auto-folding
let g:vim_markdown_new_list_item_indent=2  " indent lists by 2 spaces in .md files
set laststatus=2
let g:lightline = {'colorscheme': 'solarized'}
let g:closetag_filenames = "*.html.*"

" General
set nocompatible                           " vim not vi mode
set mouse=a                                " allow mouse in all modes
set autoread                               " automatically reload buffers
set autowrite                              " automatically save files
set nobackup                               " disable backups
set nowritebackup                          " write file in place
set noswapfile                             " no .swap files
set backspace=indent,eol,start             " make backspace behave normal
set ttyfast                                " I have a fast terminal
set visualbell                             " don't beep
set noerrorbells                           " don't beep

" Search
set incsearch                              " incremental search
set ignorecase                             " seach case insensitive...
set smartcase                              " ... unless it contains capital letter
set wildignore+=*/tmp/*,*.so,*.swp,*.zip   " ignore tmp directories
if executable('ag')                        " use the_silver_searcher (if available)
  " use for grep
  set grepprg=ag\ --nogroup\ --nocolor\ --column
  set grepformat=%f:%l:%c%m

  " use for ctrl-p
  let g:ctrlp_user_command = 'ag %s -l --nocolor -g ""'
  let g:ctrlp_use_caching = 0
else
  let g:ctrlp_custom_ignore = 'node_modules\|DS_Store\|git'
endif

" Navigation
nnoremap <C-J> <C-W><C-J>        " faster split navigation
nnoremap <C-K> <C-W><C-K>
nnoremap <C-L> <C-W><C-L>
nnoremap <C-H> <C-W><C-H>
set scrolloff=2                  " start scrolling 3 lines off the border
map <C-n> :NERDTreeToggle<CR>    " toggle NERDTree with ctrl n
nnoremap <Tab> :bnext<CR>        " cylce through buffers

" Editing
set expandtab                              " use softtabs
set tabstop=2
set shiftwidth=2
set shiftround
filetype plugin indent on                  " filetype matching indention
syntax on                                  " syntax highlighting
set wrap linebreak nolist                  " line wrapping
set breakindent                            " indent wrapped lines

" Spelling
autocmd BufRead,BufNewFile *.md setlocal spell   " spell check for markdown files
set complete+=kspell                             " autocomplete words

" Appearance
set ruler                                  " display cursor position
set colorcolumn=80                         " highlight 80 char column
set number                                 " show line numbers
set t_Co=256                               " use 256 colors
let g:solarized_termtrans=1
colorscheme solarized
set background=dark
set noshowmode                             " hide default status line

" Functions
fun! StripTrailingWhiteSpace()             " Strip trailing whitespaces (where needed)
  if &ft =~ 'markdown'
    return
  endif
  %s/\s\+$//e
endfun
autocmd bufwritepre * :call StripTrailingWhiteSpace()
