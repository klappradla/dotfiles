#!/usr/bin/env bash
#
# dots
#
# `dots` handles installation, updates, things like that. Run it periodically
# to make sure you're on the latest and greatest.

set -o errexit
set -o nounset
set -o pipefail

readonly RED="\033[0;31m"
readonly NO_COLOR="\033[0m"
readonly DOTFILES="$HOME/dotfiles"

print_usage() {
  echo "dots -- manage dotfiles"
  echo ""
  echo "Usage: dots [<option>]"
  echo ""
	echo "  -i, --install   Install dotfiles"
	echo "  -u, --update    Update dotfiles"
	echo "  -e, --edit      Open dotfiles directory for editing"
	echo "  -h, --help      Show this help message and exit"
}

edit_dotfiles() {
  cd "$DOTFILES"
  exec "$EDITOR" "$DOTFILES"
  exit
}

invalid_usage() {
  echo -e "$RED""Invalid option: ""$NO_COLOR""$1"
  echo ""
  print_usage
  exit 1
}

if [ $# -lt 1 ]; then
  print_usage
  exit 1
fi

option=$1
case $option in
  "-h"|"--help")
    print_usage
    ;;
  "-i"|"--install")
    "$DOTFILES/scripts/setup.sh"
    ;;
  "-u"|"--update")
    "$DOTFILES/scripts/update.sh"
    ;;
  "-e"|"--edit")
    edit_dotfiles
    ;;
  *)
    invalid_usage "$option"
    ;;
esac
